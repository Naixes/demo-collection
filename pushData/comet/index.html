<meta charset="utf-8">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<h1>测试comet</h1>
<script type="text/javascript">
	// 方案1
	var getXmlHttpRequest = function () {
		if (window.XMLHttpRequest) {
			return new XMLHttpRequest
		}
		else if (window.ActiveXObject) {
			return new ActiveXObject("Microsoft.XMLHTTP")
		}
	}
	var xhr = getXmlHttpRequest()
	xhr.onreadystatechange = function () {
		console.log(xhr.readyState)
		if (xhr.readyState === 3 && xhr.status === 200) {
			console.log(xhr.responseText)
		}
	}
	xhr.open("get", "data.php", true)
	xhr.send("")
	// 方案2/3
	function conn() {
		$.ajax({
			url: 'data.php',
			dataType: 'json',
			success: function (data) {
				console.log(data)
				// 递归调用
				conn()
			}
		})
	}
	conn()
</script>